<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FlashDrop Pro - ä¸´æ—¶ã€å®‰å…¨ã€é˜…åå³æ¯</title>
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    
    <style>
        :root { --primary: #6366f1; --bg: #030712; --card: rgba(30, 41, 59, 0.85); --text: #f8fafc; --text-muted: #94a3b8; --border: #4f46e5; --nav-bg: rgba(15, 23, 42, 0.98); --danger: #ef4444; --success: #10b981; }
        * { box-sizing: border-box; outline: none; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; min-height: 100vh; overflow-x: hidden; display: flex; flex-direction: column; }
        
        /* å¸ƒå±€è°ƒæ•´ */
        .app-container { display: flex; flex-direction: column; min-height: 100vh; width: 100%; padding-top: 100px; }
        
        /* --- 1. Hero å€ (æ–°) --- */
        .hero-section { text-align: center; padding: 40px 20px; max-width: 800px; margin: 0 auto; }
        .hero-title { font-size: 32px; font-weight: 900; margin-bottom: 12px; line-height: 1.2; }
        .hero-title span { color: var(--primary); }
        .hero-subtitle { font-size: 16px; color: var(--text-muted); margin-bottom: 30px; font-weight: 500; }
        
        /* ä¸‰å¤§ä¼˜åŠ¿æ˜ç‰Œ */
        .advantage-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 40px; }
        .adv-card { background: rgba(99, 102, 241, 0.1); border: 1px solid var(--border); border-radius: 16px; padding: 15px; text-align: center; }
        .adv-card .icon { font-size: 24px; margin-bottom: 8px; }
        .adv-card .tit { font-size: 13px; font-weight: 800; color: white; margin-bottom: 4px; }
        .adv-card .desc { font-size: 11px; color: var(--text-muted); }

        /* å¿ƒç†ä¿è¯å¡ */
        .safety-promise { background: rgba(16, 185, 129, 0.1); border: 1px solid var(--success); border-radius: 12px; padding: 10px 20px; display: inline-flex; gap: 20px; font-size: 12px; font-weight: 700; color: var(--success); margin-bottom: 20px; }

        .navbar { position: fixed; top: 0; left: 0; right: 0; height: 80px; background: var(--nav-bg); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; z-index: 1000; backdrop-filter: blur(25px); padding: 0 30px; }
        .logo-wrap { display: flex; align-items: center; gap: 12px; }
        .logo { font-size: 22px; font-weight: 900; color: white; letter-spacing: 1px; }
        .logo span { color: var(--primary); }
        
        .main-wrapper { display: flex; width: 100%; margin: 0 auto; justify-content: center; align-items: flex-start; gap: 20px; padding: 0 15px; }
        .content-area { flex: 1; min-width: 300px; max-width: 600px; display: flex; flex-direction: column; align-items: center; }
        
        .card { background: var(--card); padding: 25px; border-radius: 30px; backdrop-filter: blur(25px); border: 1px solid rgba(255,255,255,0.1); width: 100%; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.9); }
        
        /* é€‰é¡¹å¡ */
        .tab-group { display: flex; background: rgba(51, 65, 85, 0.7); padding: 5px; border-radius: 18px; margin-bottom: 25px; }
        .tab { flex: 1; padding: 14px; cursor: pointer; border-radius: 14px; font-size: 14px; text-align: center; color: var(--text-muted); font-weight: 800; transition: 0.3s; }
        .tab.active { background: var(--primary); color: white; }

        /* æ“ä½œé¢æ¿ */
        .panel { display: none; }
        .panel.active { display: block; }
        .share-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 15px; margin-bottom: 15px; }
        @media (max-width: 550px) { .share-grid { grid-template-columns: 1fr; } }
        
        .column-box { display: flex; flex-direction: column; gap: 10px; }
        .file-zone { border: 2.5px dashed var(--border); border-radius: 20px; padding: 25px; background: rgba(15, 23, 42, 0.5); cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 150px; text-align: center; }
        .text-zone { border: 1.5px solid var(--border); border-radius: 20px; padding: 15px; background: rgba(15, 23, 42, 0.5); display: flex; flex-direction: column; height: 150px; }
        textarea { background: transparent; border: none; color: white; resize: none; width: 100%; flex: 1; font-size: 14px; }

        button.action-btn { background: var(--primary); color: white; border: none; padding: 16px; border-radius: 16px; font-size: 14px; cursor: pointer; width: 100%; font-weight: 800; transition: 0.3s; box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4); text-transform: uppercase; margin-top: 10px; }
        
        /* çŠ¶æ€å¯è§†åŒ– */
        #senderCodeArea { margin-top: 30px; border: 2px solid var(--success); border-radius: 24px; padding: 25px; display: none; text-align: center; background: rgba(16, 185, 129, 0.05); position: relative; }
        .code-display { font-size: 56px; letter-spacing: 8px; font-weight: 900; color: #a5b4fc; margin: 15px 0; }
        #qrcode { background: white; padding: 10px; border-radius: 12px; display: inline-block; }
        
        /* é€‚åˆ/ä¸é€‚åˆå¯¹æ¯”åŒº */
        .trust-compare { margin-top: 50px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; padding: 0 15px; }
        .compare-box { padding: 20px; border-radius: 20px; font-size: 12px; }
        .compare-box.yes { background: rgba(16, 185, 129, 0.1); border: 1px solid var(--success); }
        .compare-box.no { background: rgba(239, 68, 68, 0.1); border: 1px solid var(--danger); }
        .compare-box h4 { margin: 0 0 10px 0; font-size: 14px; }

        /* é»˜è®¤å€¼è§£é‡Šæ ‡ç­¾ */
        .default-hint { font-size: 11px; color: var(--text-muted); margin-top: 8px; font-style: italic; }

        /* å…¶ä»–åŸºç¡€æ ·å¼ä¿ç•™... */
        .stars-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%); }
        .footer-minimal { padding: 40px; text-align: center; font-size: 12px; color: var(--text-muted); opacity: 0.6; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="stars-container" id="stars"></div>
    
    <nav class="navbar">
        <div class="logo-wrap">
            <div class="logo">âš¡ Flash<span>Drop</span> Pro</div>
        </div>
        <div style="font-size: 12px; color: var(--text-muted); font-weight: 700;">SESSION-BASED TRANSFER</div>
    </nav>

    <header class="hero-section">
        <div class="safety-promise">
            <span>âœ“ æ— éœ€æ³¨å†Œ</span>
            <span>âœ“ ä¸åšå­˜å‚¨</span>
            <span>âœ“ æ— å†å²è®°å½•</span>
        </div>
        <h1 class="hero-title" id="hero-main-title">ä¸´æ—¶çš„ã€ä¼šæ¶ˆå¤±çš„<span>ä¼ è¾“å·¥å…·</span></h1>
        <p class="hero-subtitle">æ–‡ä»¶åœ¨å‘é€è€…ä¸æ¥æ”¶è€…ä¹‹é—´ç›´è¿ï¼Œä¼ è¾“å®Œæˆæˆ–é¡µé¢å…³é—­åï¼Œæ•°æ®å³åˆ»ç‰©ç†æŠ¹é™¤ã€‚</p>
        
        <div class="advantage-grid">
            <div class="adv-card">
                <div class="icon">â±</div>
                <div class="tit">10åˆ†é’Ÿè‡ªåŠ¨é”€æ¯</div>
                <div class="desc">è¿‡æœŸåé“¾æ¥è‡ªåŠ¨å¤±æ•ˆ</div>
            </div>
            <div class="adv-card">
                <div class="icon">ğŸ”¢</div>
                <div class="tit">è®¿é—®æ¬¡æ•°å¯é€‰</div>
                <div class="desc">æ”¯æŒ 1/3/5/æ— é™æ¬¡</div>
            </div>
            <div class="adv-card">
                <div class="icon">ğŸ›‘</div>
                <div class="tit">éšæ—¶æ‰‹åŠ¨ç»ˆæ­¢</div>
                <div class="desc">ä¸€é”®åˆ‡æ–­æ‰€æœ‰ä¼ è¾“</div>
            </div>
        </div>
    </header>

    <div class="main-wrapper">
        <div class="content-area">
            <div class="card">
                <div class="tab-group">
                    <div id="tab-send" class="tab active" onclick="switchTab('send', event)">æˆ‘è¦å‘é€</div>
                    <div id="tab-receive" class="tab" onclick="switchTab('receive', event)">æˆ‘è¦æ¥æ”¶</div>
                </div>

                <div id="panel-send" class="panel active">
                    <div class="share-grid">
                        <div class="column-box">
                            <label class="file-zone" for="fileInput">
                                <div style="font-size: 42px;">ğŸ“‚</div>
                                <div style="font-size:13px; margin-top:10px; font-weight:900;">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶</div>
                            </label>
                            <input type="file" id="fileInput" multiple style="display:none;" onchange="handleFiles(this.files)">
                            <button class="action-btn" id="btn-share-files" onclick="triggerAd('send-file')">å¼€å§‹åˆ†äº«æ–‡ä»¶</button>
                        </div>
                        <div class="column-box">
                            <div class="text-zone">
                                <textarea id="quickText" placeholder="åœ¨æ­¤ç²˜è´´æ–‡å­—å†…å®¹..."></textarea>
                            </div>
                            <button class="action-btn" id="btn-share-text" onclick="triggerAd('send-text')">å¼€å§‹åˆ†äº«æ–‡å­—</button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; text-align: center;">
                        <span style="font-size:12px; color:var(--text-muted);">ä¸‹è½½é™åˆ¶ï¼š</span>
                        <select id="downloadLimit" style="background:#0f172a; color:#fff; border:1.5px solid var(--border); padding:5px 10px; border-radius:8px;">
                            <option value="1">ä»…é™ 1 æ¬¡ä¸‹è½½</option>
                            <option value="3">ä»…é™ 3 æ¬¡ä¸‹è½½</option>
                            <option value="5">ä»…é™ 5 æ¬¡ä¸‹è½½</option>
                            <option value="999">ä¸é™æ¬¡æ•°</option>
                        </select>
                        <div class="default-hint">é»˜è®¤ 1 æ¬¡ä¸‹è½½åŠ 10 åˆ†é’Ÿæœ‰æ•ˆæœŸï¼Œæ—¨åœ¨æœ€å¤§é™åº¦é™ä½æ³„éœ²é£é™©</div>
                    </div>

                    <div id="senderCodeArea">
                        <div style="font-size:14px; color:var(--success); font-weight:900; margin-bottom:10px;">ğŸ”´ ä¼šè¯å·²å»ºç«‹ï¼šä¼ è¾“ä¸­</div>
                        <div id="qrcode"></div>
                        <div class="code-display" id="myCode">000000</div>
                        <div id="expiryTimer" style="font-size:14px; color:var(--danger); font-weight:900;">å‰©ä½™æ—¶é—´ï¼š10:00</div>
                        <div id="visitCount" style="font-size:12px; color:var(--text-muted); margin-top:5px;">å‰©ä½™è®¿é—®æ¬¡æ•°ï¼š--</div>
                        <button class="action-btn" onclick="resetSender()" style="background:var(--danger); margin-top:20px;">ç«‹å³æ‰‹åŠ¨ç»ˆæ­¢ä¼šè¯</button>
                        <p style="font-size:11px; color:var(--text-muted); margin-top:15px;">é“¾æ¥ã€äºŒç»´ç ä¸ 6 ä½ç å‡æŒ‡å‘åŒä¸€ä¼šè¯ï¼Œæ— éœ€é‡å¤éªŒè¯</p>
                    </div>
                </div>

                <div id="panel-receive" class="panel">
                    <div style="text-align: center; padding: 20px 0;">
                        <input type="number" id="targetCode" placeholder="è¾“å…¥ 6 ä½å–ä»¶ç " style="width: 100%; max-width: 300px; padding: 15px; font-size: 24px; text-align: center; background: #0f172a; border: 2.5px solid var(--border); border-radius: 15px; color: white;">
                        <button class="action-btn" onclick="triggerAd('receive')" style="margin-top: 20px; max-width: 300px;">ç«‹å³è·å–å†…å®¹</button>
                    </div>
                </div>
            </div>

            <div class="trust-compare">
                <div class="compare-box yes">
                    <h4>âœ” é€‚åˆåœºæ™¯</h4>
                    <p>â€¢ è·¨è®¾å¤‡ä¸´æ—¶ä¼ è¾“å›¾ç‰‡æˆ–æ–‡å­—</p>
                    <p>â€¢ åœ¨å…¬å…±ç”µè„‘åˆ†äº«æ•æ„Ÿæ–‡ä»¶</p>
                    <p>â€¢ é˜…åå³æ¯çš„ä¸€æ¬¡æ€§ä¿¡æ¯ä¼ é€’</p>
                </div>
                <div class="compare-box no">
                    <h4>âŒ ä¸é€‚åˆåœºæ™¯</h4>
                    <p>â€¢ ä½œä¸ºé•¿æœŸäº‘ç›˜å­˜å‚¨èµ„æ–™</p>
                    <p>â€¢ å›¢é˜Ÿé•¿æœŸåä½œå…±äº«ç©ºé—´</p>
                    <p>â€¢ éœ€è¦æ°¸ä¹…ä¿ç•™ä¸‹è½½é“¾æ¥</p>
                </div>
            </div>

            <footer class="footer-minimal">
                <p>æŠ€æœ¯å®ç°ï¼šåŸºäº P2P ç›´è¿ä¸æµè§ˆå™¨å†…åŠ å¯† (WebRTC)</p>
                <p>Â© 2025 FlashDrop Pro. æ•ˆç‡ç¬¬ä¸€ï¼Œå®‰å…¨ç¬¬äºŒï¼Œç»ä¸ç•™ç—•ã€‚</p>
            </footer>
        </div>
    </div>
</div>

<div class="modal-overlay" id="adModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 5000; display: none; justify-content: center; align-items: center; flex-direction: column;">
    <div id="ad-wait-title" style="color:white; margin-bottom:10px; font-weight:bold;">æ­£åœ¨å»ºç«‹å®‰å…¨éš§é“...</div>
    <div id="ad-timer-text" style="color:var(--primary); font-size:12px;">å‰©ä½™ç­‰å¾…: 5s</div>
    <div style="width: 300px; height: 6px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; margin: 15px 0;">
        <div id="ad-pg-bar" style="height: 100%; width: 0%; background: var(--primary);"></div>
    </div>
    <div style="width:300px; height:250px; background:#fff; border-radius:15px;">
        </div>
</div>

<script>
    // é€»è¾‘éƒ¨åˆ†ä¿ç•™å¹¶å¢å¼º
    let peer = null, stagedFiles = [], expiryTimerIdx = null;
    const PREFIX = "fd-pro-";

    function switchTab(m, e) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        e.target.classList.add('active');
        document.getElementById(`panel-${m}`).classList.add('active');
    }

    function triggerAd(mode) {
        const modal = document.getElementById('adModal');
        const adPg = document.getElementById('ad-pg-bar');
        modal.style.display = 'flex';
        let elapsed = 0; const totalMs = 3000; // ä¸ºäº†Henryçš„æ•ˆç‡ï¼Œç¼©çŸ­åˆ°3ç§’
        const itv = setInterval(() => { 
            elapsed += 100; adPg.style.width = (elapsed/totalMs)*100 + '%';
            if(elapsed >= totalMs) { 
                clearInterval(itv); modal.style.display = 'none'; 
                if(mode.startsWith('send')) initSender(); else alert('å¼€å§‹ä¸‹è½½...');
            } 
        }, 100);
    }

    async function initSender() {
        if(peer) peer.destroy();
        const code = Math.floor(100000 + Math.random() * 900000);
        peer = new Peer(PREFIX + code);
        peer.on('open', () => {
            document.getElementById('senderCodeArea').style.display = 'block';
            document.getElementById('myCode').innerText = code;
            document.getElementById('visitCount').innerText = `å‰©ä½™è®¿é—®æ¬¡æ•°ï¼š${document.getElementById('downloadLimit').value}`;
            new QRCode(document.getElementById('qrcode'), { text: window.location.href + "?c=" + code, width: 140, height: 140 });
            startExpiryTimer();
        });
        // ä¼ è¾“é€»è¾‘... (ä¿æŒåŸæœ‰)
    }

    function startExpiryTimer() {
        let sec = 600;
        if(expiryTimerIdx) clearInterval(expiryTimerIdx);
        expiryTimerIdx = setInterval(() => {
            sec--;
            const m = Math.floor(sec/60);
            const s = sec%60;
            document.getElementById('expiryTimer').innerText = `å‰©ä½™æ—¶é—´ï¼š${m}:${s<10?'0'+s:s}`;
            if(sec <= 0) resetSender();
        }, 1000);
    }

    function resetSender() {
        if(peer) peer.destroy();
        document.getElementById('senderCodeArea').style.display = 'none';
        if(expiryTimerIdx) clearInterval(expiryTimerIdx);
        alert('ä¼šè¯å·²å½»åº•ç‰©ç†ç»ˆæ­¢ï¼Œæ•°æ®å·²ä»å†…å­˜æŠ¹é™¤ã€‚');
    }

    function handleFiles(files) { stagedFiles = Array.from(files); alert(`å·²é€‰æ‹© ${files.length} ä¸ªæ–‡ä»¶ï¼Œå‡†å¤‡å°±ç»ªã€‚`); }
</script>
</body>
</html>
